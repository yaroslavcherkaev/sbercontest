# Конкурс красоты кода

## Что внутри?

Для конкурса мной был реализован телеграмм чат-бот, симулирующие торговлю на фондовом рынке.


Решение содержит следующие модули:  

1. ```server.py``` -- серверная часть, логика бота.
2. ```profile.py``` -- функции для изменения состояния профиля пользователя
3. ```exchange.py``` -- функции симулирующие торговлю
4. ```broker.py``` --  функции симулирующие проверки брокера
5. ```beautiful_types.py``` -- мои типы

## Запустить локально

В переменных окружения добавить:

```TELEGRAM_API_TOKEN = {ваш токен}```

Установить зависимости из ```pip_requirements.txt```:

```pip install -r pip_requirements.txt```

Запустить ```server.py```

## Пара слов о реализации

Если нет активных заявок типа ```SELL``` в БД, то покупка совершается у эмитента, 
то есть просто начисляются акции и списывается сумма с баланса.

Если есть активные заявки с одинаковым кол-вом акции на продажу,
то выбирается самая поздняя заявка, и обмен совершается с ее инициатором.

Соответственно продажа акций возможна, только если есть такая же заявка на покупку.

Продать акции эмитенту нельзя.

Средства и активы зачисляются только после закрытия сделки.

Так же учитывается удержанная сумма на покупку и кол-во акций, которые выставлены на продажу.

## Доступные команды бота

Посмотреть баланс: /balance

Посмотреть рынок: /assets

Пополнить баланс: /change_balance 1000

Посмотреть портфель: /portfolio

Посмотреть команды:  /help

Посмотреть заявки: /orders

Купить пакет акций: /buy SBER 1

Продать пакет акций: /sell VTBR 1




